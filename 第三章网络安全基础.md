# 第三章 网络安全基础
## 第一节 网络安全概述

### 网络安全事件回放

1. **网络的定义**
    - 定义：计算机网络是指将地理位置不同，具有**独立功能(或自治能力)** 的多个计算机系统用**通信设备和线路连接起来**，并以功能完善的网络软件（网络协议、网络操作系统等）进行信息交换，实现**资源共享和协同工作**的系统。
    - 特征：
      - 网络中包含两台以上的地理位置不同具有“自治能力”的计算机。
      - 网络中各结点之间的连接需要有一条通道，由传输介质实现物理互联。
      - 网络中各结点之间互相通信或交换信息，需要有某些约定和规则，实现各结点的逻辑互联。 
      - 计算机网络是以实现数据通信和网络资源（包括硬件资源和软件资源）共享和协作为目的。

2. **网络的结构**
    - OSI参考模型是国际标准化组织(ISO)为解决异种机互连而制定的开放式计算机网络层次结构模型，它的最大优点是将服务、接口和协议这三个概念明确地区分开来。
    - 网络通信分为七层，从下到上分别是：物理层（Physical Layer）、数据链路层（Data Link Layer，简称为链路层）、网络层（NetWork Layer）、传输层（Transport Layer）、会话层（Session Layer）、表示层（Presentation Layer）以及应用层（Application Layer）。
    - ![OSI](image/image-18.png)

3. **网络安全现状**
   - 计算机病毒层出不穷，并呈现新的传播态势和特点
   - 黑客对全球网络的恶意攻击势头逐年攀升
   - 由于技术和设计上的不完备，导致系统存在缺陷或安全漏洞
   - 世界各国军方都在加紧进行信息战的研究

4. **网络安全事件**
<!-- 1. **海湾战争网络安全事件**
   - 1991年，美国特工人员在安曼将伊拉克从德国进口的打印机设备中换上含有可控“计算机病毒”的芯片，导致伊方计算机系统全面瘫痪。

1. **Microsoft公司网站遭袭**
   - 2000年10月25日，Microsoft公司网站遭到来自俄罗斯黑客的袭击，系统瘫痪，部分源代码丢失。

2. **中美黑客大战**
   - 2001年4月4日，美国黑客组织攻击中国网站，随后中国黑客发起网络反击战。

3. **ATM机被黑客攻击**
   - 2010年黑帽大会上，美国安全公司IOActive展示ATM机被黑客攻击，导致现金被非法取出。

4. **飞机电脑系统被黑客攻击**
   - 2013年荷兰黑客安全大会上，德国网络安全工程师Hugo Teso展示绕过飞机安全检查系统接管飞机电脑系统。

5. **特斯拉Model S系统被攻破**
   - 2014年10月黑客大赛，特斯拉Model S系统被攻破，实现远程操控。

6. **微信等苹果APP发现Xcode恶意后门**
   - 2015年9月14日，微信等近350款苹果APP发现存在Xcode恶意后门。

7. **汇丰银行遭受DDoS攻击**
   - 2016年1月4日和1月29日，汇丰银行遭受DDoS攻击，服务中断。

8. **WannaCry勒索病毒爆发**
   - 2017年5月12日，WannaCry勒索病毒利用“永恒之蓝”漏洞传播，影响超过10万台电脑。 

9.  **万豪国际酒店客户资料泄露**
    - 2018年11月30日，万豪国际酒店客户系统被黑客侵入，约5亿客户资料泄露。-->

### 网络安全威胁与防护措施
1. **网络安全概念**
   - 定义：网络安全指网络系统的硬件、软件及其系统中的数据受到保护，不因偶然的或者恶意的原因而遭受破坏、更改、泄露，系统连续可靠正常地运行，网络服务不中断。
   - 本质：网络上的信息系统安全。
   - 网络安全包括**系统安全运行**和**系统信息安全保护**两方面：
     - 信息系统的安全运行是信息系统提供有效服务(即可用性)的前提
     - 信息的安全保护主要是确保数据信息的机密性和完整性
   - 涉及内容：技术方面侧重于防范外部的入侵，管理方面则侧重于内部人为因素的管理。
   - 安全领域普遍认为“最大的漏洞就是人”。
   - 目标：**机密性、完整性、可用性、非否认性、可靠性、可控性、可审查性**

2. **安全威胁和攻击概念**
   - **安全威胁**：
     - 指对某一资源的保密性、完整性、可用性或合法使用所造成的危险。
   - 脆弱性：指在实施防护措施中或缺少防护措施时系统所具有的弱点。
   - 风险：是对某个已知的、可能引发某种成功攻击的脆弱性的代价的测度。风险分析能够提供定量的方法，以确定是否应保证在防护措施方面的投入。
   - 漏洞：从广义上讲，硬件、软件、协议的具体实现或系统安全策略以及人为因素上存在的缺陷，从而可以使攻击者能够在未经系统合法用户授权的情况下访问或破坏系统。
   - **攻击**：
     - 一种故意逃避安全服务（特别是从方法和技术上）并且破坏系统安全策略的智能行为；任何可能危及机构信息安全，破坏系统安全属性的行为；攻击就是某个安全威胁的具体实施
   

1. **网络信息安全的典型威胁**
   - 包括窃听、信息泄露、病毒感染、非法使用、完整性侵犯、拒绝服务、假冒、流量分析等。
   - 分类：
     - 物理威胁
     - 操作系统缺陷
     - 网络协议缺陷
     - 体系结构缺陷
     - 黑客程序
     - 计算机病毒

2. **典型威胁及其相互关系**
   - ![典型威胁及其关系](image/image-19.png)
  
3. **安全防护措施**
   - 包括技术防护和管理措施，以防范外部入侵和内部人为因素的管理。

### 安全攻击的分类及常见形式
1. **安全攻击的种类**
   - 包括被动攻击和主动攻击。
   - 被动攻击：对所传输的信息进行窃听和监测；
   - 主动攻击：恶意篡改数据流或伪造数据流等攻击行为； 
   - 被动攻击虽然难以检测，但采取某些安全防护措施就可以有效阻止；而主动攻击虽然易于检测，但却难以阻止。
   - ![攻击](image/image-20.png)
     - Interruption 中断 破坏可用性
     - Interception 截取 破坏机密性
     - Modification 修改 破坏完整性
     - Fabrication 伪造 破坏真实性

2. **攻击树**
   - 攻击树是一种**以分支模型直观地表示计算机安全威胁的方法（或威胁建模）**，用来确定哪些威胁最有可能，以及如何有效地阻止威胁。
   - 攻击的目标，如访问机密文件，是攻击树的根。
   - 每个分支代表实现该目标的不同方法，这些分支机构可能会从多个方向跳出，有各种不同的选择来实施这些方法

3. **攻击过程分析**
   - **预攻击（踩点和扫描）**
     - 目的：收集信息，进行进一步攻击决策
     - 内容：
       - 获得域名及IP分布
       - 获得拓扑及OS等
       - 获得端口和服务
       - 获得应用系统情况
       - 跟踪新漏洞发布
   - **攻击（入侵、获取权限、提升权限）**
     - 目的：进行攻击，获得系统的一定权限
     - 内容：
       - 获得远程权限
       - 进入远程系统
       - 提升本地权限
       - 进一步扩展权限
       - 进行实质性操作
   - **后攻击（清除日志、安插后门）**
     - 目的：消除痕迹，长期维持一定的权限
     - 内容：
       - 植入后门木马
       - 删除日志
       - 修补明显的漏洞
       - 进一步渗透扩展   

4. **安全攻击常见八种形式**
   - 包括口令窃取、欺骗攻击、缺陷和后门攻击、缓冲区溢出、网络蠕虫攻击、认证失效攻击、协议缺陷攻击、信息泄漏攻击等。

    1. **口令窃取**
       - **口令猜测攻击的三种基本方式：**
         - 利用已知或假定的口令尝试登录（口令字典、暴力破解、社会工程学字典攻击）；
         - 根据窃取的口令文件进行猜测；
         - 窃听某次合法终端之间的会话，并记录所使用的口令；
       - **抵御口令猜测攻击方式：**
         - 阻止选择低级口令，采用更为复杂的口令；
         - 对口令文件严格保护；
       - **彻底解决口令机制的弊端：**
         - 使用基于令牌的机制，例如一次性口令方案（OTP-One-Time Password）。
  
    2. **欺骗攻击**
       - 采用欺骗的方式（假冒、伪装等）获取合法信息并加以利用，获得权限：
         - Web欺骗（钓鱼邮件）；
         - IP欺骗；
         - DNS欺骗（域名劫持）；
         - ARP欺骗。

    3. **缺陷和后门攻击**
       - **缺陷：** 指程序中某些代码不能满足特定需求。
       - **后门：** 指能绕开正常的安全访问机制而直接访问程序的程序代码。
       - **缓冲器溢出（堆栈粉碎）攻击：** 程序对接受的输入数据没有进行有效检测导致的错误，可能造成程序崩溃或者是执行攻击者的命令。
         - 一种扰乱程序的攻击方法
         - 在堆栈上执行代码时出现程序指针紊乱      
       - **网络蠕虫攻击**：利用操作系统和应用程序**漏洞**传播，通过网络的通信功能将自身从一个结点发送到另一个结点并启动运行的程序，可以造成网络服务遭到拒绝并发生死锁。**蠕虫是一段独立的可执行程序，它可以通过计算机网络把自身的拷贝（复制品）传给其他的计算机。**
         - 方式之一是向守护程序发送新的代码
         - 蠕虫向“读”缓冲区内注入大量的数据

    4. **缓冲区溢出**
       - 这种攻击可以使一个匿名的Internet用户有机会获得一台主机的部分或全部的控制权。
       - 攻击者向一个有限空间的缓冲区中复制过长的字符串，可能造成程序瘫痪或系统崩溃，或让攻击者运行恶意代码，执行任意指令，甚至获得管理员用户的权限。

    5. **网络蠕虫攻击**
       - 网络蠕虫攻击是一种通过某种网络媒介，无须计算机使用者干预即可运行的独立程序，通过主动寻找目标计算机，不停的获得网络中存在漏洞的计算机上的部分或全部控制权来将代码副本进行传播。
       - 蠕虫攻击大量地消耗计算机时间和网络通信带宽，导致整个计算机系统及其网络的崩溃，成为拒绝服务攻击的工具。
       - 蠕虫会搜集、扩散、暴露系统敏感信息（如用户信息等），并在系统中留下后门。这些都会导致未来的安全隐患。

    6. **认证失效攻击**
       - **认证机制的失效**易导致服务器被攻击者欺骗，此攻击会使系统对访问者所采取的**身份认证措施无效**。

    7. **协议缺陷攻击**
       - 协议本身的缺陷导致攻击的发生
         - TCP/IP协议、DNS和许多基于RPC的协议易遭到序列号攻击
         - IP协议易遭受地址欺骗攻击
         - HTTP协议、FTP协议等无安全考虑，易遭受攻击
         - 802.11无线数据通信标准中的WEP协议也存在缺陷
           - 通过改进协议设计消除此缺陷，如我国的WAPI标准

    8. **信息泄漏攻击**
       - 信息泄露的方式包括利用协议缺陷攻破系统、获得信息，软硬件故障导致意外泄密，病毒侵袭，以及内部信息安全管理不善所导致。
       - 信息泄露会使攻击者获得有价值的系统相关信息，并用之攻破系统

    9.  **指数攻击**
       - 指数攻击通常指的是攻击者利用系统或网络的某个特性，以极快的速度增长攻击力度，使得防御措施难以跟上攻击的变化。

    10. **拒绝服务攻击（DOS攻击）**
        - 拒绝服务攻击(DoS)指攻击者利用系统缺陷，通过执行一些恶意的操作而使得合法的系统用户不能及时地得到应得的服务或系统资源。
        - 分布式拒绝服务攻击（Distributed Denial of Service， DDoS）是一种基于DoS攻击、但形式特殊的拒绝服务攻击，采用一种分布、协作的大规模攻击方式。

    11. **SYN Flood（泛洪）攻击**
        - SYN Flood攻击是一种常见的DoS攻击，通过发送大量的SYN请求来消耗服务器的资源，导致服务器无法处理正常的请求。

    12. **Smurf 攻击**
        - Smurf攻击是一种拒绝服务攻击，攻击者发送大量的ICMP回显请求数据包到一个广播地址，使得网络上的所有主机都向被攻击的主机发送ICMP回显应答。

    13. **社会工程学攻击**
        - 社会工程学攻击是一种通过受害者心理弱点、本能反应、好奇心、信任、贪婪等心理陷阱进行欺骗、伤害等危害手段，取得自身利益的手法。
        - 社会工程学是非传统的信息安全
        - 常用的手段:环境渗透、引诱、伪装、恐吓、恭维、说服
        

### OSI模型与安全体系结构
1. **ISO 7498-2标准**
   - 确定了OSI开放系统互连参考模型的信息安全体系结构。
   - 充分体现信息安全层次性和结构性特点，是一个以防护为主的静态的安全体系结构。  

2. **OSI安全体系结构模型**
   - 包括安全服务、安全机制和安全攻击。
   - ![OSI](image/image-21.png)

3. **安全服务**
   - 分为认证服务、访问控制服务、数据机密性服务、数据完整性服务和非否认服务。
   1. **认证服务**
      - **定义：** 提供关于某个实体（人或事物）身份的保证，证实实体声明的身份。
      - 认证服务是可控性服务的重要组成部分，通常使用在需要提交人或者事物的身份的这一类特殊的通信过程中。
      - **类型：**
        - **对等实体认证（Peer Entity Authentication）：** 确认通信过程中远端用户的身份。
        - **数据起源认证（Data Origin Authentication）：** 确认数据发送者的身份，保证数据的真正起源。

   2. **访问控制服务**
      - **定义：** 实施授权的一种方法，防止对资源的未授权使用。
      - **作用：**
        - 保护资源以防止非授权访问和操纵。
        - 保护敏感信息不经过有风险的环境传送。
        - 限制实体的访问权限，通常是经过认证的合法实体。

   3. **数据机密性服务**
      - **定义：** 保护信息不泄露或不暴露给未授权的实体。
      - **保密粒度：** 流（stream）、消息（message）、选择字段（field）
      - **内容：**
        - **数据的机密性服务：** 使用加密手段保护数据不被未授权者推断出敏感信息。
        - **业务流机密性服务：** 防止攻击者从分析网络业务流中得到敏感信息。

   4. **数据完整性服务**
      - **定义：** 确保数据的价值和存在性没有改变，对抗数据篡改攻击。
      - **内容：**
        - **单个数据单元或字段的完整性：** 保护数据单元不被非授权者修改。
        - **数据单元流或字段流的完整性：** 保护数据单元序列的完整性，防止数据单元的重放。

   5. **非否认服务（不可抵赖性）**
      - **定义：** 阻止参与某次通信交换的一方在事后否认曾经发生过本次交换的事实。
      - **类型：**
        - **起源的否认：** 向数据接收者提供数据源的证据，防止发送者否认发送过数据。
        - **传递的否认：** 向数据发送者提供数据已交付给接收者的证据，防止接收者否认收到数据。

4. **安全机制**
   - 安全服务与安全机制关系：
     - 安全服务体现了安全系统的功能；而安全机制则是安全服务的实现。
     - 一个安全服务可以由多个安全机制实现；而一个安全机制也可以用于实现多个安全服务中。
     - ![安全服务与安全机制关系](image/image-22.png)

### 网络安全模型
1. **网络安全模型-网络通信**
   - 保护信息传输，需要提供**安全机制和安全服务**。
       - 一部分是对发送的信息进行与安全相关的转换。例如，消息的加密，使开放网络对加密的消息不可读；又如附加一些基于消息内容的码，用来验证发送者的身份。
       - 另一部分是由两个主体共享的秘密信息，而对开放网络是保密的。例如，用以加密转换的密钥，用于发送前的加密和接收前的解密。
   - 需要可信的第三方
   - 一种能被通信主体使用的协议，这种协议使用安全算法和秘密信息以便获得特定的安全服务。
   - ![网络通信](image/image-23.png)

2. **网络安全模型-访问安全**
   - 考虑了黑客攻击、病毒与蠕虫等的非授权访问。
   - 黑客攻击可以形成两类威胁：一类是**信息访问威胁**，即非授权用户截获或修改数据；另一类是**服务威胁**，即服务缺陷以禁止合法用户使用。
   - 病毒和蠕虫是软件攻击的两个实例，这类攻击通常是通过移动存储介质引入系统，并隐藏在有用软件中；也可通过网络接入系统。
   - 两个层次：
     - **网闸或看门人功能**，组织非授权用户访问
     - 内部安全控制（监控）：监测有害入侵者的存在
   - ![访问安全](image/image-24.png)

3. **网络安全模型- P2DR-时间模型**
   - P2DR模型是可量化的、可由数学证明的、基于时间的的安全模型， 
   - 包含安全策略(Policy)、防护(Protection)、检测(Detection)和响应(Response)。
     - 安全策略是P2DR安全模型的核心，所有的防护、检测、响应都是依据策略实施的;
     - 防护主要是预防安全事件的发生，发现存在的系统脆弱性和防止意外威胁和恶意威胁;
     - 检测是P2DR中一个非常重要的环节，是**静态防护转化为动态防护的关键**，动态响应和加强防护的依据，同时也是强制落实安全策略的工具;
     - 响应在安全系统中占有重要的地位，是解决安全潜在威胁最有效的方法。
   - 基本思想：信息安全相关的所有活动，无论是攻击、防护、检测和响应行为，都要消耗时间，因此可以用**时间尺度**来衡量一个体系的能力和安全性。
   - 理论：系统的检测时间与响应时间越长,或对系统的攻击时间越短,则系统的暴露时间越长,系统就越不安全;如果系统的暴露时间$E_t<=0$(即$D_t+R_t<=P_t$),那么认为系统是安全的
   - 安全的目标：尽可能地增大保护时间,尽量地减少检测时间和响应时间。  
   

4. **网络安全模型- PDRR**
   - 包括防护（Protection）、检测（Detection）、响应（Response）、恢复（Recovery）
   - 这4个部分构成了一个**动态的信息安全周期**
   - ![PDRR](image/image-25.png)    